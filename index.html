<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valentic d.o.o.</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />

    <!-- Include Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <!-- Bootstrap ICONS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Include Flatpickr CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />

    <!--STYLE.CSS-->
    <link rel="stylesheet" href="index.css" />
  </head>

  <body>
    <div class="container-fluid">
      <!--NAVBAR-->
      <div class="container-fluid">
        <header class="d-flex py-3">
          <a class="navbar-brand float-left" href="index.html">
            <img src="./asstes/logo.png" alt="Logo" height="30" />
          </a>
          <ul class="nav mx-auto">
            <li class="nav-item">
              <a href="index.html" class="nav-link active" aria-current="page"
                >Nova narudžba</a
              >
            </li>
            <li class="nav-item">
              <a href="narudzbe.html" class="nav-link" aria-current="page"
                >Narudžbe</a
              >
            </li>
            <li class="nav-item">
              <a href="prodavaci.html" class="nav-link" aria-current="page"
                >Prodavači</a
              >
            </li>
            <li class="nav-item">
              <a href="kupci.html" class="nav-link">Kupci</a>
            </li>
            <li class="nav-item">
              <a href="uredivanje_narudzbe.html" class="nav-link" aria-current="page"
                >Uređivanje narudžbe</a
              >
            </li>
            
              <li class="nav-item">
                
            </li>
          </ul>
          <ul>
            <div class="row mb-3">
              <div class="col guid-class">
                <input
                  type="text"
                  class="form-control border-warning border-2 text-dark text-center guid-class"
                  name="guid"
                  id="guid"
                  list="list-salesman"
                  value=""
                  required
                />
              </div>
            </div>
          </ul>
        </header>
      </div>
    </div>
      <!--NAVBAR-->
      

    <div class="container-fluid" id="main-container">
      <div class="container-fluid" id="formOrderData-container">
        <!--FORMA-->
        <form id="orderForm">
         
            <!--ID NARUDŽBE-->
            <div class="row my-3">
              <label
                for="narudzba_id"
                class="input-group-text col-sm-3 col-form-label"
                >NARUDŽBA</label
              >
              <div class="col">
                <input
                  type="text"
                  class="form-control"
                  name="narudzba_id"
                  id="narudzba_id"
                 
                />
              </div>
            </div>
             <!--PRODAVAČ-->
          <div class="row mb-3">
            <label
              for="prodavac"
              class="input-group-text col-sm-3 col-form-label"
              >Prodavač</label
            >
            <div class="col-sm-7 col-md-8">
              <input
                type="text"
                class="form-control"
                name="prodavac"
                id="prodavac"
                list="list-salesman"
                value=""
                oninput="fetchSalesmanId(this)"
                required
              />
            </div>
            <div class="col-sm-2 col-md-1 text-sm-end text-end text-md-end">
              <a
                class="btn btn-warning btn-prodavaci"
                target="_blank"
                href="prodavaci.html"
                role="button"
                
              >
              <i class="bi bi-person-add"></i>
              </a>

            </div>
          </div>
            <!--NARUČITELJ-->
            <div class="row mb-3" id="narucitelj-container">
              <label
                for="narucitelj"
                class="input-group-text col-form-label col-sm-3"
                id="narucitelj-label"
                >Naručitelj</label
              >
              <div class="col-sm-7 col-md-8">
                <input
                  type="text"
                  class="form-control"
                  name="narucitelj"
                  id="narucitelj"
                  list="list-clients"
                  value=""
                  oninput="fetchClientId(this)"
                  required
                />
              </div>
              <div class="col-sm-2 col-md-1 text-sm-end text-end text-md-end" id="button-narucitelj">
                <a
                class="btn btn-dark btn-kupci"
                target="_blank"
                href="kupci.html"
                role="button"
                
              >
              <i class="bi bi-people"></i>
              </a>
              
              <!--Button + kreiraj Naručitelja-->

              </div>
              
               
             
            </div>

            <!--DATUM KREIRANJE NARUDŽBE-->

            <div class="row mb-3">
              <label
                for="datumNarudzbe"
                class="input-group-text col-sm-3 col-form-label"
                >Datum narudžbe</label
              >
              <div class="col">
                <input
                  type="date"
                  id="datumNarudzbe"
                  name="datumNarudzbe"
                  class="form-control"
                  value="2023-11-13"
                  pattern="\d{4}-\d{2}-\d{2}"
                />
              </div>
            </div>

            <!--DATUM DOSTAVE-->
            <div class="row mb-3">
              <label
                for="datum-dostave"
                class="input-group-text col-sm-3 col-form-label"
                >Datum dostave</label
              >
              <div class="col">
                <input
                  type="date"
                  id="datumDostave"
                  name="datumDostave"
                  class="form-control"
                  value="2023-11-20"
                  pattern="\d{4}-\d{2}-\d{2}"
                />
              </div>
            </div>
            
            <!--TABLICA-->
            <table class="table mt-3" id="tablica">
              <thead>
                <tr>
                  <th class="col-7">Naziv Artikla</th>

                  <th class="col-2">Količina</th>
                  <th class="col-2">Cijena</th>
                  <th class="col-1"></th>
                  <th class="col-0" type="hidden"></th>
                </tr>
              </thead>
              <tbody id="tbody">
                <!--Adding rows-->
              </tbody>
            </table>
  
            <!--BUTTON DODAJTE ARTIKL-->
            <a class="btn btn-success mr-3 btn-plus" role="button" id="addRow">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-plus-lg"
                viewBox="0 0 16 16"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"
                />
              </svg>
            </a>
          </div>
  
          <!--BUTTON SUBMIT TABLE ITEMS-->
          <div class="container-fluid my-3 text-sm-end mr-3" id="button-submit">
            <button type="submit" class="btn btn-primary text-uppercase btn-spremi">
              Spremi Narudžbu
            </button>
          </div>
          </form>
           <!--KRAJ FORME-->

        </div>



      <!--LISTA PRODAVAČA-->
      <datalist id="list-salesman">


      </datalist>
      <!--LISTA PRODUKTA-->
      <datalist id="list-products">
      </datalist>
      <!--LISTA KLIJENTA-->
      <datalist id="list-clients">
      </datalist>
      <!--LISTA Adresa-->
      <datalist id="list-address"></datalist>
    </div>

    <script src="index.js" charset="UTF-8"></script>
    <!-- Include Bootstrap and Flatpickr JavaScript DATUM NARUDŽBE-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"
    ></script>
    <script>
      // Initialize Flatpickr with the desired options
      // flatpickr("#datumNarudzbe", {
      //   dateFormat: "Y-m-d",
      //   defaultDate: "today", // Set the default date to today
      //   allowInput: true, // Allow manual input
      //   disableMobile: "true"
      // });
      // flatpickr("#datumDostave", {
      //   dateFormat: "Y-m-d",
      //   allowInput: true, // Allow manual input
      //   disableMobile: "true"
      // });

  

  


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Populate data from "https://demo.cadcam-group.eu/api" to PRODAVAČ
      // Definiranje funkcije za popunjavanje option liste
      function popuniOptionListuProdavac(data) {
        const datalistProdavac = document.getElementById("list-salesman");
        // Prolazimo kroz dobivene podatke i dodajemo ih kao opcije u datalist
        data.forEach(client =>{
          const markup = `<option client-id="${client.id}" client-guid="${client.GUID}">${client.ime + " " + client.prezime}</options>`;

          document.querySelector("#list-salesman").insertAdjacentHTML("beforeend", markup);
        });
      }
      // Definiranje podataka za POST zahtjev
      const postDataProdavac = [
    {
        "action": "tblprodavaci"
    }
];
      // POST zahtjev na API endpoint
      fetch('https://demo.cadcam-group.eu/admin/', {
        method: 'POST',
        body: JSON.stringify(postDataProdavac),
        headers: {
          'Content-Type':'application/json'
        }
      })
      .then(response => response.json())
      .then(data => {
        // Pozivamo funkciju za popunjavanje option liste s dobivenim podacima
        popuniOptionListuProdavac(data);
      })
      .catch(error => {
        console.error('Došlo je do pogreške:', error);
      })

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Populate data from "https://demo.cadcam-group.eu/api" to NARUČITELJ
  // Definiranje funkciju za popunjavanje option liste
  function popuniOptionListuNarucitelj(data) {
      const datalist = document.getElementById('list-clients');

      // Prolazimo kroz dobivene podatke i dodajemo ih kao opcije u datalist
      data.forEach(client => {
        const markup= `<option client-id="${client.id}" client-oib="${client.OIB}">${client.ime + " - " + client.adresa}</option>`;
        datalist.insertAdjacentHTML("beforeend", markup);
         
      });
  }

  // Definirajte podatke za POST zahtjev
  const postDataNarucitelji = [
      {
          "action": "tblklijenti"
      }
  ];

  // POST zahtjev na API endpoint
  fetch('https://demo.cadcam-group.eu/admin/', {
      method: 'POST',
      body: JSON.stringify(postDataNarucitelji),
      headers: {
          'Content-Type': 'application/json'
      }
  })
      .then(response => response.json())
      .then(data => {
          // Pozivamo funkciju za popunjavanje option liste s dobivenim podacima
          popuniOptionListuNarucitelj(data);
      })
      .catch(error => {
          console.error('Došlo je do pogreške:', error);
      });
    </script>
  </body>
</html>


